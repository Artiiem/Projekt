---
title: "projekt"
author: "Artur Kidaj"
date: "2023-10-12"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE , warning=FALSE}
library(openxlsx)
library(kableExtra)
library(knitr)
library(gt)
library(tidyverse)

```

## Wczytanie danych

```{r}
data <- read.csv("udemy_courses.csv")

data <- data[,-3]
data <- data[,-1]
```

W naszym projekcie skupimy się na analizie bazy danych "Udemy courses".

Oto pierwsze pięć wierszy z tabeli.

```{r}
gt(head(data,5))
```

## Zmienne

-   Tytuł - Tytuł kursu.

-   Płatny - Informuje o tym, czy dany kurs jest płatny.

-   Cena - Ukazuje cenę kursu wyrażoną w dolarach.

-   Subskrybenci - Ukazuje liczbę subskrybentów kursu.

-   Recenzje - Ukazuje liczbę recenzji kursu.

-   Wykłady - Ukazuje liczbę wykładów kursu.

-   Poziom - Przedstawia poziom trudności kursu podzielną na cztery kategorie:

    -   *Beginner Level* - poziom początkujący.

    -   *Intermediate Level* - poziom średniozaawansowany.

    -   *Expert Level* - poziom zaawansowany.

    -   *All levels* - wszystkie poziomy.

-   Długość - Ukazuje długość kursu wyrażoną w godzinach.

-   Opublikowano - Przedstawia datę publikacji kursu o następującej strukturze:

    *rok-miesiąc-dzień T - godzina:minuta:sekunda Z*

-   Temat - Przedstawia temat kursu wyrażonego w czterech różnych kategoriach:

    -   *Business Finance* - finanse? finanse przedsiębiorstw?

    -   *Graphic Design* -projekt graficzny.

    -   *Musical Instruments* - muzyczne instrumenty.

    -   *Web Development* - tworzenie/rozwój stron internetowych.
    
## Czyszczenie i przygotowanie danych

```{r}
data_clean <- data %>%
  filter(!is.na(price)) %>%
  mutate(price = as.numeric(price))
```

## Analiza eksploracyjna

Podstawowe statystyki
```{r}
summary(data)
```
## Wizualizacja danych

 Wizualizacja rozkładu ceny kursów  
```{r}
ggplot(data, aes(x = price)) + 
  geom_histogram(bins = 30, fill = "blue", color = "black") +
  theme_minimal() +
  labs(title = "Rozkład ceny kursów", x = "Cena", y = "Liczba kursów")
```

```{r}
data %>%
  group_by(subject) %>%
  summarise(count = n()) %>%
  ggplot(aes(x = reorder(subject, -count), y = count, fill = subject)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Liczba kursów w każdej kategorii", x = "Kategoria", y = "Liczba kursów") +
  coord_flip()

```

## Modelowanie danych

Jakiś model

```{r}
model <- lm(price ~ num_subscribers, data = data_clean)
summary(model)
```

## Wnioski